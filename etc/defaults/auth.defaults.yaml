# Authentication Configuration for OneTimeSecret
# Controls the authentication mode and related settings
---

# Authentication mode: off, 'basic' (Redis-only) or 'advanced' (SQL + Redis)
mode: basic

# Shared session configuration (both modes)
session:
  secret: <%= ENV['SESSION_SECRET'] %>
  expire_after: 86400       # 24 hours
  key: 'onetime.session'        # Unified cookie name
  secure: true              # Set based on SSL configuration
  same_site: strict

# Mode-specific configurations
basic:
  # Basic mode settings (Redis-only authentication)
  password_hash_cost: 12
  session_timeout: 86400    # 24 hours

advanced:
  # Database connection for Advanced
  # database_url: "postgres://user:password@host:port/database"
  database_url: "sqlite://data/auth.db"

  # Service URL (used for internal requests)
  service_url: "http://127.0.0.1:9393/auth"

  # Advanced features to enable
  features:
    - login
    - logout
    - create_account
    - close_account
    - change_password
    - reset_password
    - active_sessions       # Session tracking
    - lockout               # Brute force protection
    - remember              # "Remember me" functionality
    - verify_account        # Email verification
    - otp                   # MFA
    - recovery_codes        # MFA backup codes
    - email_auth            # Magic links (passwordless email login)
    - webauthn              # Biometric/security key authentication

  # Security settings
  security:
    password_minimum_length: 8
    max_invalid_logins: 5
    lockout_expiration: 3600     # 1 hour
    session_expire_after: 86400  # 24 hours
    require_email_confirmation: false  # Set to true when email is configured
