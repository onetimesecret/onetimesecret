#!/bin/bash

# Loads models, applications, logic, and test helpers. Unlike running
# `bin/ots console`, does not boot or run any initialization code.

# Determine which apps to load based on AUTHENTICATION_MODE
AUTH_MODE="${AUTHENTICATION_MODE:-basic}"

if [ "$AUTH_MODE" = "advanced" ]; then
  # Advanced mode: load auth application
  irb -Ilib -r onetime -r onetime/models -r onetime/middleware \
      -Iapps/api -r v2/application \
      -Iapps/web -r core/application -r auth/application \
      -Itry/support -r test_helpers -r test_models -r test_logic
else
  # Basic mode: skip auth application
  irb -Ilib -r onetime -r onetime/models -r onetime/middleware \
      -Iapps/api -r v2/application \
      -Iapps/web -r core/application \
      -Itry/support -r test_helpers -r test_models -r test_logic
fi
