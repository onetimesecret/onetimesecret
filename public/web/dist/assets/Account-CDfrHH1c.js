import{r,d as B,o as d,c as u,a as e,t as i,w as U,b as x,u as s,I as V,e as f,p as L,f as O,_ as Y,g as J,h as _,i as D,v as T,j as Q,k as W}from"./main-oYL6ejTX.js";function N(a){const p=r(!1),c=r(""),h=r("");return{isSubmitting:p,error:c,success:h,submitForm:async w=>{var v;p.value=!0,c.value="",h.value="";try{const y=w.target,I=new FormData(y),k=new URLSearchParams(I),g=await fetch(a.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:k.toString()});if(!g.ok)if((v=g.headers.get("content-type"))!=null&&v.includes("application/json")){const P=await g.json();throw new Error(P.message||"Submission failed")}else throw new Error("Please refresh the page and try again.");h.value=a.successMessage,a.onSuccess&&await a.onSuccess(g),a.redirectUrl&&setTimeout(()=>{window.location.href=a.redirectUrl},a.redirectDelay||3e3)}catch(y){y instanceof Error?c.value=y.message:(console.error("An unexpected error occurred",y),c.value="An unexpected error occurred")}finally{p.value=!1}}}}const X=a=>(L("data-v-fdec2b43"),a=a(),O(),a),Z={key:0,class:"mb-4 p-4 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500 rounded-lg shadow-lg"},ee={class:"font-mono text-lg text-white"},te={class:"bg-black bg-opacity-20 p-3 rounded flex items-center overflow-x-auto relative"},se={class:"break-all pr-10"},oe=X(()=>e("p",{class:"text-white text-sm mt-2 font-semibold"}," ðŸ” Keep this token secure! It provides full access to your account. ",-1)),re=B({__name:"APIKeyCard",props:{token:{default:""},onCopy:{type:Function,default:()=>{}}},setup(a){const p=a,c=r(!1),h=()=>{navigator.clipboard.writeText(p.token).then(()=>{c.value=!0,setTimeout(()=>{c.value=!1},2e3),p.onCopy()}).catch(l=>{console.error("Failed to copy text: ",l)})};return(l,w)=>l.token?(d(),u("div",Z,[e("div",ee,[e("div",te,[e("span",se,i(l.token),1),e("button",{onClick:U(h,["stop"]),type:"button",class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-200 transition-colors duration-200"},[x(s(V),{icon:c.value?"heroicons-outline:check":"heroicons-outline:clipboard-copy",class:"w-6 h-6"},null,8,["icon"])])])]),oe])):f("",!0)}}),ae=Y(re,[["__scopeId","data-v-fdec2b43"]]),ne={class:"max-w-2xl mx-auto p-4"},ie=e("h1",{class:"text-3xl font-bold mb-6 dark:text-white"},"Your Account",-1),ce={class:"text-lg mb-4 dark:text-gray-300"},le={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-6"},de=e("h2",{class:"text-xl font-semibold mb-4 dark:text-white flex items-center"},[e("i",{class:"fas fa-exclamation-triangle text-red-500 mr-2"}),e("span",{class:"flex-1"},"API Key")],-1),ue={class:"pl-3"},pe={class:"hidden"},me=["value"],he={key:0,class:"text-red-500 mb-4"},ye={key:1,class:"text-green-500 mb-4"},ge={type:"submit",class:"w-full bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded flex items-center justify-center"},fe=e("i",{class:"fas fa-trash-alt mr-2"},null,-1),we=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},null,-1),be={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-6"},xe=e("h2",{class:"text-xl font-semibold mb-4 dark:text-white flex items-center"},[e("i",{class:"fas fa-lock mr-2"}),_(" Update Password ")],-1),_e={class:"pl-3"},ve={class:"hidden"},ke=["value"],Pe=e("label",{for:"username"},"Username",-1),Se=e("input",{type:"text",id:"username",autocomplete:"username"},null,-1),Ce={class:"mb-4 relative"},Ae=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Current Password",-1),De={class:"relative"},Ue=["type"],Ve={class:"mb-4 relative"},Ie=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Password",-1),Me={class:"relative"},Te=["type"],$e={class:"mb-4 relative"},je=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Confirm",-1),Ee={class:"relative"},Ke=["type"],Fe={key:0,class:"text-red-500 mb-4"},ze={key:1,class:"text-green-500 mb-4"},Ne={type:"submit",class:"w-full bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded flex items-center justify-center"},Be=e("i",{class:"fas fa-save mr-2"},null,-1),Re={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},qe=e("h2",{class:"text-xl font-semibold mb-4 dark:text-white flex items-center"},[e("i",{class:"fas fa-exclamation-triangle text-red-500 mr-2"}),e("span",{class:"flex-1"},"Delete Account")],-1),Ge={class:"pl-3"},He=W('<p class="mb-4 dark:text-gray-300">Please be advised:</p><ul class="list-disc list-inside mb-4 dark:text-gray-300"><li><span class="font-bold">Secrets will remain active until they expire.</span></li><li>Any secrets you wish to remove, <a href="#" class="underline">burn them before continuing</a>.</li><li>Deleting your account is <span class="italic">permanent and non-reversible.</span></li></ul>',2),Le=e("i",{class:"fas fa-trash-alt mr-2"},null,-1),Oe={class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},Ye={class:"mt-6 text-sm text-gray-600 dark:text-gray-400"},Je={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Qe={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg"},We=e("h3",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"},"Confirm Account Deletion",-1),Xe=e("p",{class:"mb-4 text-gray-700 dark:text-gray-300"},"Are you sure you want to permanently delete your account? This action cannot be undone.",-1),Ze=e("input",{type:"hidden",name:"tabindex",value:"destroy"},null,-1),et={class:"mb-4"},tt={key:0,class:"text-red-500 mb-4"},st={class:"flex justify-end space-x-4"},ot=["disabled"],rt={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},at=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),nt=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),it=[at,nt],ct={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor"},lt=e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1),dt=[lt],pt=B({__name:"Account",setup(a){const p=window.custid,c=window.cust,h=window.customer_since,l=window.shrimp,w=r(window.apitoken),v=r(c.plan.options.name),y=r(c.secrets_created),I=r(h),k=r(""),g=r(""),P=r(""),m=J({current:!1,new:!1,confirm:!1}),S=r(!1),C=r(""),b=r(!1),A=r(""),R=async()=>{b.value=!0,A.value="";try{const n=new URLSearchParams;if(n.append("confirmation",C.value),l)n.append("shrimp",l);else throw new Error("Shrimp value is missing");const t=await fetch("/api/v1/account/destroy",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()});if(!t.ok){const H=(await t.json()).message;throw new Error(H||"Failed to delete account")}S.value=!1,window.location.href="/"}catch(n){n instanceof Error?A.value=n.message||"An error occurred while deleting the account":console.error("An unexpected error occurred",n)}finally{b.value=!1}},{isSubmitting:q,error:$,success:j,submitForm:E}=N({url:"/api/v1/account/apikey",successMessage:"Key generated.",onSuccess:async n=>{const t=await n.json();w.value=t.apikey}}),{isSubmitting:G,error:K,success:F,submitForm:z}=N({url:"/api/v1/account/change-password",successMessage:"Password updated successfully."}),M=n=>{m[n]=!m[n]};return(n,t)=>(d(),u("div",ne,[ie,e("p",ce,"Account type: "+i(v.value),1),e("div",le,[de,e("div",ue,[e("form",{onSubmit:t[0]||(t[0]=U((...o)=>s(E)&&s(E)(...o),["prevent"]))},[e("div",pe,[e("input",{type:"text",name:"shrimp",value:s(l)},null,8,me)]),x(ae,{token:w.value},null,8,["token"]),s($)?(d(),u("div",he,i(s($)),1)):f("",!0),s(j)?(d(),u("div",ye,i(s(j)),1)):f("",!0),e("button",ge,[fe,_(" "+i(s(q)?"Generating...":"Generate Key"),1)]),we],32)])]),e("div",be,[xe,e("div",_e,[e("form",{onSubmit:t[7]||(t[7]=U((...o)=>s(z)&&s(z)(...o),["prevent"]))},[e("div",ve,[e("input",{type:"hidden",name:"shrimp",value:s(l)},null,8,ke),Pe,Se]),e("div",Ce,[Ae,e("div",De,[D(e("input",{type:m.current?"text":"password",name:"currentp",id:"currentPassword","onUpdate:modelValue":t[1]||(t[1]=o=>k.value=o),required:"",autocomplete:"current-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,Ue),[[T,k.value]]),e("button",{type:"button",onClick:t[2]||(t[2]=o=>M("current")),class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[x(s(V),{icon:m.current?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),e("div",Ve,[Ie,e("div",Me,[D(e("input",{type:m.new?"text":"password",name:"newp",id:"newPassword","onUpdate:modelValue":t[3]||(t[3]=o=>g.value=o),required:"",autocomplete:"new-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,Te),[[T,g.value]]),e("button",{type:"button",onClick:t[4]||(t[4]=o=>M("new")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100"},[x(s(V),{icon:m.new?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),e("div",$e,[je,e("div",Ee,[D(e("input",{type:m.confirm?"text":"password",name:"newp2",id:"confirmPassword","onUpdate:modelValue":t[5]||(t[5]=o=>P.value=o),required:"",autocomplete:"confirm-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,Ke),[[T,P.value]]),e("button",{type:"button",onClick:t[6]||(t[6]=o=>M("confirm")),class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[x(s(V),{icon:m.confirm?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),s(K)?(d(),u("div",Fe,i(s(K)),1)):f("",!0),s(F)?(d(),u("div",ze,i(s(F)),1)):f("",!0),e("button",Ne,[Be,_(" "+i(s(G)?"Updating...":"Update Password"),1)])],32)])]),e("div",Re,[qe,e("div",Ge,[He,e("button",{onClick:t[8]||(t[8]=o=>S.value=!0),class:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded flex items-center justify-center"},[Le,_(" Permanently Delete Account ")]),e("p",Oe,"Deleting "+i(s(p)),1)])]),e("p",Ye," Created "+i(y.value)+" secrets since "+i(I.value)+". ",1),S.value?(d(),u("div",Je,[e("form",{onSubmit:U(R,["prevent"]),class:"w-full max-w-md"},[e("div",Qe,[We,Xe,Ze,e("div",et,[D(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>C.value=o),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",autocomplete:"confirmation",placeholder:"Confirm with your password"},null,512),[[Q,C.value]])]),A.value?(d(),u("p",tt,i(A.value),1)):f("",!0),e("div",st,[e("button",{onClick:t[10]||(t[10]=o=>S.value=!1),type:"button",class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-400 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}," Cancel "),e("button",{type:"submit",disabled:!C.value||b.value,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 dark:bg-red-700 dark:hover:bg-red-800 flex items-center disabled:opacity-50 disabled:cursor-not-allowed"},[b.value?(d(),u("svg",rt,it)):(d(),u("svg",ct,dt)),_(" "+i(b.value?"Deleting...":"Delete Account"),1)],8,ot)])])],32)])):f("",!0)]))}});export{pt as default};
